!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.MobileDragDrop=t.MobileDragDrop||{})}(this,function(t){"use strict";var e="dnd-poly-",i=["none","copy","copyLink","copyMove","link","linkMove","move","all"],n=["none","copy","move","link"],o=function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("test",null,e)}catch(t){}return t}();function r(t){return t&&t.tagName}function s(t,e,i){void 0===i&&(i=!0),document.addEventListener(t,e,!!o&&{passive:i})}function h(t,e){document.removeEventListener(t,e)}function a(t,e,i,n){return n&&(i=i.bind(n)),t.addEventListener(e,i),{off:function(){return t.removeEventListener(e,i)}}}function d(t){return 0===t.length?0:t.reduce(function(t,e){return e+t},0)/t.length}function l(t,e){for(var i=0;i<t.changedTouches.length;i++)if(t.changedTouches[i].identifier===e)return!0;return!1}function c(t,e,i){for(var n=[],o=[],r=0;r<e.touches.length;r++){var s=e.touches[r];n.push(s[t+"X"]),o.push(s[t+"Y"])}i.x=d(n),i.y=d(o)}var u=["","-webkit-"];function f(t,e,i,n,o){void 0===o&&(o=!0);var r=e.x,s=e.y;n&&(r+=n.x,s+=n.y),o&&(r-=parseInt(t.offsetWidth,10)/2,s-=parseInt(t.offsetHeight,10)/2);for(var h="translate3d("+r+"px,"+s+"px, 0)",a=0;a<u.length;a++)t.style[u[a]+"transform"]=h+" "+i[a]}var g=function(){function t(t,e){this.t=t,this.i=e,this.s=n[0]}return Object.defineProperty(t.prototype,"dropEffect",{get:function(){return this.s},set:function(t){0!==this.t.mode&&i.indexOf(t)>-1&&(this.s=t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"types",{get:function(){if(0!==this.t.mode)return Object.freeze(this.t.types)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"effectAllowed",{get:function(){return this.t.effectAllowed},set:function(t){2===this.t.mode&&i.indexOf(t)>-1&&(this.t.effectAllowed=t)},enumerable:!0,configurable:!0}),t.prototype.setData=function(t,e){if(2===this.t.mode){if(t.indexOf(" ")>-1)throw new Error("illegal arg: type contains space");this.t.data[t]=e,-1===this.t.types.indexOf(t)&&this.t.types.push(t)}},t.prototype.getData=function(t){if(1===this.t.mode||2===this.t.mode)return this.t.data[t]||""},t.prototype.clearData=function(t){if(2===this.t.mode){if(t&&this.t.data[t]){delete this.t.data[t];var e=this.t.types.indexOf(t);return void(e>-1&&this.t.types.splice(e,1))}this.t.data={},this.t.types=[]}},t.prototype.setDragImage=function(t,e,i){2===this.t.mode&&this.i(t,e,i)},t}();function p(t,e){return t?t===i[0]?n[0]:0===t.indexOf(i[1])||t===i[7]?n[1]:0===t.indexOf(i[4])?n[3]:t===i[6]?n[2]:n[1]:3===e.nodeType&&"A"===e.tagName?n[3]:n[1]}function v(t,e,i,n,o,r,s){void 0===r&&(r=!0),void 0===s&&(s=null);var h=function(t,e,i,n,o,r,s){void 0===s&&(s=null);var h=e.changedTouches[0],a=new Event(i,{bubbles:!0,cancelable:n});a.dataTransfer=r,a.relatedTarget=s,a.screenX=h.screenX,a.screenY=h.screenY,a.clientX=h.clientX,a.clientY=h.clientY,a.pageX=h.pageX,a.pageY=h.pageY;var d=t.getBoundingClientRect();return a.offsetX=a.clientX-d.left,a.offsetY=a.clientY-d.top,a}(e,i,t,r,document,o,s),a=!e.dispatchEvent(h);return n.mode=0,a}function m(t,e){if(!t||t===i[7])return e;if(e===n[1]){if(0===t.indexOf(n[1]))return n[1]}else if(e===n[3]){if(0===t.indexOf(n[3])||t.indexOf("Link")>-1)return n[3]}else if(e===n[2]&&(0===t.indexOf(n[2])||t.indexOf("Move")>-1))return n[2];return n[0]}var y,b=function(){function t(t,e,i,n){this.h=t,this.o=e,this.u=i,this.l=n,this.v=0,this.p=null,this.g=null,this.m=t,this.I=t.changedTouches[0],this.j=this.S.bind(this),this.k=this.A.bind(this),s("touchmove",this.j,!1),s("touchend",this.k,!1),s("touchcancel",this.k,!1)}return t.prototype.O=function(){var t=this;this.v=1,this.C=n[0],this.D={data:{},effectAllowed:void 0,mode:3,types:[]},this.M={x:null,y:null},this.F={x:null,y:null};var e=this.u;if(this.N=new g(this.D,function(i,n,o){e=i,"number"!=typeof n&&"number"!=typeof o||(t.P={x:n||0,y:o||0})}),this.D.mode=2,this.N.dropEffect=n[0],v("dragstart",this.u,this.m,this.D,this.N))return this.v=3,this.T(),!1;c("page",this.m,this.F);var i,o=this.o.dragImageSetup(e);if(this.L=(i=o,u.map(function(t){var e=i.style[t+"transform"];return e&&"none"!==e?e.replace(/translate\(\D*\d+[^,]*,\D*\d+[^,]*\)\s*/g,""):""})),o.style.position="absolute",o.style.left="0px",o.style.top="0px",o.style.zIndex="999999",o.classList.add("dnd-poly-drag-image"),o.classList.add("dnd-poly-icon"),this._=o,!this.P)if(this.o.dragImageOffset)this.P={x:this.o.dragImageOffset.x,y:this.o.dragImageOffset.y};else if(this.o.dragImageCenterOnTouch){var r=getComputedStyle(e);this.P={x:0-parseInt(r.marginLeft,10),y:0-parseInt(r.marginTop,10)}}else{var s=e.getBoundingClientRect();r=getComputedStyle(e),this.P={x:s.left-this.I.clientX-parseInt(r.marginLeft,10)+s.width/2,y:s.top-this.I.clientY-parseInt(r.marginTop,10)+s.height/2}}return f(this._,this.F,this.L,this.P,this.o.dragImageCenterOnTouch),document.body.appendChild(this._),this.V=window.setInterval(function(){t.X||(t.X=!0,t.Y(),t.X=!1)},this.o.iterationInterval),!0},t.prototype.T=function(){this.V&&(clearInterval(this.V),this.V=null),h("touchmove",this.j),h("touchend",this.k),h("touchcancel",this.k),this._&&(this._.parentNode.removeChild(this._),this._=null),this.l(this.o,this.m,this.v)},t.prototype.S=function(t){var e=this;if(!1!==l(t,this.I.identifier)){if(this.m=t,0===this.v){var i=void 0;if(this.o.dragStartConditionOverride)try{i=this.o.dragStartConditionOverride(t)}catch(t){i=!1}else i=1===t.touches.length;return i?void(!0===this.O()&&(this.h.preventDefault(),t.preventDefault())):void this.T()}if(t.preventDefault(),c("client",t,this.M),c("page",t,this.F),this.o.dragImageTranslateOverride)try{var n=!1;if(this.o.dragImageTranslateOverride(t,{x:this.M.x,y:this.M.y},this.p,function(t,i){e._&&(n=!0,e.M.x+=t,e.M.y+=i,e.F.x+=t,e.F.y+=i,f(e._,e.F,e.L,e.P,e.o.dragImageCenterOnTouch))}),n)return}catch(t){}f(this._,this.F,this.L,this.P,this.o.dragImageCenterOnTouch)}},t.prototype.A=function(t){if(!1!==l(t,this.I.identifier)){if(this.o.dragImageTranslateOverride)try{this.o.dragImageTranslateOverride(void 0,void 0,void 0,function(){})}catch(t){}0!==this.v?(t.preventDefault(),this.v="touchcancel"===t.type?3:2):this.T()}},t.prototype.Y=function(){var t=this,i=this.C;this.D.mode=3,this.N.dropEffect=n[0];var o=v("drag",this.u,this.m,this.D,this.N);if(o&&(this.C=n[0]),o||2===this.v||3===this.v)return this.q(this.v)?void function(t,e,i,n){var o=getComputedStyle(t);if("hidden"!==o.visibility&&"none"!==o.display){e.classList.add("dnd-poly-snapback");var r=getComputedStyle(e),s=parseFloat(r.transitionDuration);if(isNaN(s)||0===s)n();else{var h=t.getBoundingClientRect(),a={x:h.left,y:h.top};a.x+=document.body.scrollLeft||document.documentElement.scrollLeft,a.y+=document.body.scrollTop||document.documentElement.scrollTop,a.x-=parseInt(o.marginLeft,10),a.y-=parseInt(o.marginTop,10);var d=parseFloat(r.transitionDelay),l=Math.round(1e3*(s+d));f(e,a,i,void 0,!1),setTimeout(n,l)}}else n()}(this.u,this._,this.L,function(){t.B()}):void this.B();var s=this.o.elementFromPoint(this.M.x,this.M.y),h=this.g;s!==this.p&&s!==this.g&&(this.p=s,null!==this.g&&(this.D.mode=3,this.N.dropEffect=n[0],v("dragexit",this.g,this.m,this.D,this.N,!1)),null===this.p?this.g=this.p:(this.D.mode=3,this.N.dropEffect=p(this.D.effectAllowed,this.u),v("dragenter",this.p,this.m,this.D,this.N)?(this.g=this.p,this.C=m(this.N.effectAllowed,this.N.dropEffect)):this.p!==document.body&&(this.g=document.body))),h!==this.g&&r(h)&&(this.D.mode=3,this.N.dropEffect=n[0],v("dragleave",h,this.m,this.D,this.N,!1,this.g)),r(this.g)&&(this.D.mode=3,this.N.dropEffect=p(this.D.effectAllowed,this.u),this.C=!1===v("dragover",this.g,this.m,this.D,this.N)?n[0]:m(this.N.effectAllowed,this.N.dropEffect)),i!==this.C&&this._.classList.remove(e+i),this._.classList.add(e+this.C)},t.prototype.q=function(t){var e=this.C===n[0]||null===this.g||3===t;return e?r(this.g)&&(this.D.mode=3,this.N.dropEffect=n[0],v("dragleave",this.g,this.m,this.D,this.N,!1)):r(this.g)&&(this.D.mode=1,this.N.dropEffect=this.C,this.C=!0===v("drop",this.g,this.m,this.D,this.N)?this.N.dropEffect:n[0]),e},t.prototype.B=function(){this.D.mode=3,this.N.dropEffect=this.C,v("dragend",this.u,this.m,this.D,this.N,!1),this.v=2,this.T()},t}(),D={iterationInterval:150,tryFindDraggableTarget:function(t){var e=t.target;do{if(!1!==e.draggable&&e.getAttribute&&"true"===e.getAttribute("draggable"))return e}while((e=e.parentNode)&&e!==document.body)},dragImageSetup:function(t){var e=t.cloneNode(!0);return function t(e,i){if(1===e.nodeType){for(var n=getComputedStyle(e),o=0;o<n.length;o++){var r=n[o];i.style.setProperty(r,n.getPropertyValue(r),n.getPropertyPriority(r))}if(i.style.pointerEvents="none",i.removeAttribute("id"),i.removeAttribute("class"),i.removeAttribute("draggable"),"CANVAS"===i.nodeName){var s=e,h=i,a=s.getContext("2d").getImageData(0,0,s.width,s.height);h.getContext("2d").putImageData(a,0,0)}}if(e.hasChildNodes())for(o=0;o<e.childNodes.length;o++)t(e.childNodes[o],i.childNodes[o])}(t,e),e},elementFromPoint:function(t,e){return document.elementFromPoint(t,e)}};function x(t){if(!y){var e=D.tryFindDraggableTarget(t);if(e)try{y=new b(t,D,e,N)}catch(e){throw N(D,t,3),e}}}function w(t){var e=t.target,i=function(){o.off(),r.off(),s.off(),clearTimeout(n)},n=window.setTimeout(function(){o.off(),r.off(),s.off(),x(t)},D.holdToDrag),o=a(e,"touchend",i,this),r=a(e,"touchcancel",i,this),s=a(window,"scroll",i,this)}function N(t,e,i){if(0===i&&t.defaultActionOverride)try{t.defaultActionOverride(e)}catch(t){}y=null}t.polyfill=function(t){if(t&&Object.keys(t).forEach(function(e){D[e]=t[e]}),!D.forceApply){var e=(i={dragEvents:"ondragstart"in document.documentElement,draggable:"draggable"in document.documentElement,userAgentSupportingNativeDnD:void 0},n=!!window.chrome||/chrome/i.test(navigator.userAgent),i.userAgentSupportingNativeDnD=!(/iPad|iPhone|iPod|Android/.test(navigator.userAgent)||n&&"ontouchstart"in document.documentElement),i);if(e.userAgentSupportingNativeDnD&&e.draggable&&e.dragEvents)return!1}var i,n;return s("touchstart",D.holdToDrag?w:x,!1),!0},Object.defineProperty(t,"__esModule",{value:!0})}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.MobileDragDrop=t.MobileDragDrop||{})}(this,function(t){"use strict";function e(t){return t===document.body||t===document.documentElement}function i(t,i){var n;if(e(t))n=0===i?t.clientLeft:t.clientTop;else{var o=t.getBoundingClientRect();n=0===i?o.left:o.top}return n}function n(t,i){return e(t)?0===i?window.innerWidth:window.innerHeight:0===i?t.clientWidth:t.clientHeight}function o(t,i,n){var o=0===i?"scrollLeft":"scrollTop",r=e(t);if(2===arguments.length)return r?document.body[o]||document.documentElement[o]:t[o];r?(document.documentElement[o]+=n,document.body[o]+=n):t[o]+=n}function r(t,e,i){return t<i?-1:e-t<i?1:0}function s(t,e,i,n){return-1===t?Math.abs(e-n):1===t?Math.abs(i-e-n):0}function h(t,e,i){var n=0===t?i.scrollX:i.scrollY;return 1===e?n>=(0===t?i.scrollWidth-i.width:i.scrollHeight-i.height):-1!==e||n<=0}var a,d,l,c,u,f={threshold:75,velocityFn:function(t,e){var i=t/e;return i*i*i*e}},g={horizontal:0,vertical:0},p={x:0,y:0};function v(){a||(a=window.requestAnimationFrame(m))}function m(){var t=0,i=0,n=e(c);0!==g.horizontal&&(t=Math.round(f.velocityFn(p.x,f.threshold)*g.horizontal),o(c,0,t)),0!==g.vertical&&(i=Math.round(f.velocityFn(p.y,f.threshold)*g.vertical),o(c,1,i)),n?u(t,i):u(0,0),a=null,y(d,c,f.threshold,g,p)&&v()}function y(t,e,a,d,l){if(!t||!e)return!1;var c={x:i(e,0),y:i(e,1),width:n(e,0),height:n(e,1),scrollX:o(e,0),scrollY:o(e,1),scrollWidth:e.scrollWidth,scrollHeight:e.scrollHeight},u={x:t.x-c.x,y:t.y-c.y};return d.horizontal=r(u.x,c.width,a),d.vertical=r(u.y,c.height,a),d.horizontal&&h(0,d.horizontal,c)?d.horizontal=0:d.horizontal&&(l.x=s(d.horizontal,u.x,c.width,a)),d.vertical&&h(1,d.vertical,c)?d.vertical=0:d.vertical&&(l.y=s(d.vertical,u.y,c.height,a)),!(!d.horizontal&&!d.vertical)}t.scrollBehaviourDragImageTranslateOverride=function(t,e,i,n){d=e,u=n,l!==i&&(c=function(t){do{if(!t)return;if(e=t,i=getComputedStyle(e),e.scrollHeight>e.clientHeight&&("scroll"===i.overflowY||"auto"===i.overflowY)||e.scrollWidth>e.clientWidth&&("scroll"===i.overflowX||"auto"===i.overflowX))return t;if(t===document.documentElement)return null}while(t=t.parentNode);var e,i;return null}(l=i)),y(d,c,f.threshold,g,p)?v():a&&(window.cancelAnimationFrame(a),a=null)},Object.defineProperty(t,"__esModule",{value:!0})});